<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resilience Hub Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0d6633 0%, #1a936f 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .logo-header {
            background: #0d6633;
            padding: 15px 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-circle {
            width: 50px;
            height: 50px;
            background: white;
            color: #0d6633;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }
        
        .logo-text {
            color: white;
            font-weight: bold;
            font-size: 22px;
            letter-spacing: 1px;
        }
        
        header {
            padding: 30px;
            text-align: center;
            background: #f8f9fa;
        }
        
        header h1 {
            color: #0d6633;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .description {
            color: #666;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
        }
        
        .selection-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .results-panel {
            flex: 2;
            min-width: 500px;
        }
        
        .boxes-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 200px;
        }
        
        .box-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #0d6633;
        }
        
        .box-title i {
            font-size: 1.2rem;
        }
        
        .box-title h2 {
            font-size: 1.2rem;
        }
        
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            background: white;
            color: #333;
            margin-bottom: 10px;
        }
        
        select:focus {
            outline: none;
            border-color: #0d6633;
            box-shadow: 0 0 0 2px rgba(13, 102, 51, 0.2);
        }
        
        .search-btn {
            width: 100%;
            padding: 15px;
            background: #0d6633;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.3s;
            margin-bottom: 20px;
        }
        
        .search-btn:hover:not(:disabled) {
            background: #1a936f;
        }
        
        .search-btn:disabled {
            background: #aaa;
            cursor: not-allowed;
        }
        
        #selected-result {
            font-style: italic;
            color: #666;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #888;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px dashed #ddd;
        }
        
        .info-content {
            margin-top: 15px;
        }
        
        .bcp-embed {
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 15px;
            background: #0d6633;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #1a936f;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            color: #666;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }
            
            .boxes-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-header">
            <div class="logo">
                <div class="logo-circle">RH</div>
                <div class="logo-text">RESILIENCE HUB</div>
            </div>
        </div>
        
        <header>
            <h1>Resilience Hub</h1>
            <p class="description">Select division, department, and year to view risk management information</p>
        </header>
        
        <div class="dashboard">
            <div class="selection-panel">
                <div class="boxes-container">
                    <div class="box">
                        <div class="box-title">
                            <i class="fas fa-sitemap"></i>
                            <h2>Division</h2>
                        </div>
                        <select id="division">
                            <option value="">Select a Division</option>
                            <option value="engineering">Engineering</option>
                            <option value="sales">Sales and Marketing</option>
                            <option value="finance">Finance</option>
                            <option value="hr">Human Resources</option>
                            <option value="operations">Operations</option>
                            <option value="research">Research and Development</option>
                        </select>
                    </div>
                    
                    <div class="box">
                        <div class="box-title">
                            <i class="fas fa-building"></i>
                            <h2>Department</h2>
                        </div>
                        <select id="department">
                            <option value="">Select a Department</option>
                        </select>
                    </div>
                    
                    <div class="box">
                        <div class="box-title">
                            <i class="fas fa-calendar-alt"></i>
                            <h2>Year</h2>
                        </div>
                        <select id="year">
                            <option value="">Select a Year</option>
                        </select>
                    </div>
                </div>
                
                <button id="search-btn" class="search-btn" disabled>
                    <i class="fas fa-search"></i> Search
                </button>
                
                <div class="box">
                    <div class="box-title">
                        <i class="fas fa-info-circle"></i>
                        <h2>Selection Summary</h2>
                    </div>
                    <p id="selected-result">Please make your selections above</p>
                </div>
            </div>
            
            <div class="results-panel">
                <h2 style="color: #0d6633; margin-bottom: 20px;">Risk Management Information</h2>
                
                <div id="results-container">
                    <div class="no-data">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <p>Please select division, department, and year, then click Search to view results</p>
                    </div>
                </div>
                
                <!-- BC Exercise Document Section -->
                <div class="box" style="margin-top: 30px;">
                    <div class="box-title">
                        <i class="fas fa-file-contract"></i>
                        <h2>BC Exercise Document</h2>
                    </div>
                    <div class="info-content">
                        <p>View the BC Exercise Document directly in the dashboard:</p>
                        
                        <div class="bcp-embed">
                            <iframe src="https://onedrive.pif.gov.sa/personal/taltamimi/_layouts/15/WopiFrame.aspx?sourcedoc={51a15634-a3f6-4dd1-957a-a280b5efc920}&action=embedview&wdStartOn=1" width="100%" height="400px" frameborder="0">This is an embedded <a target="_blank" href="https://office.com">Microsoft Office</a> document, powered by <a target="_blank" href="https://office.com/webapps">Office Online</a>.</iframe>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <a href="https://onedrive.pif.gov.sa/personal/taltamimi/_layouts/15/WopiFrame.aspx?sourcedoc={51a15634-a3f6-4dd1-957a-a280b5efc920}&action=embedview&wdStartOn=1" 
                               target="_blank" class="btn">
                                <i class="fas fa-external-link-alt"></i> Open BC Exercise Document in New Tab
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 Resilience Hub | Risk Management Dashboard</p>
        </footer>
    </div>

    <script>
        // Populate year dropdown
        const yearSelect = document.getElementById('year');
        const currentYear = new Date().getFullYear();
        for (let year = currentYear; year >= currentYear - 5; year--) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            yearSelect.appendChild(option);
        }

        // Department options based on division
        const divisionSelect = document.getElementById('division');
        const departmentSelect = document.getElementById('department');
        const searchBtn = document.getElementById('search-btn');
        const selectedResult = document.getElementById('selected-result');
        const resultsContainer = document.getElementById('results-container');
        
        const departments = {
            engineering: ['Software Development', 'Quality Assurance', 'DevOps', 'Infrastructure'],
            sales: ['Sales', 'Marketing', 'Business Development', 'Customer Success'],
            finance: ['Accounting', 'Auditing', 'Financial Planning', 'Tax'],
            hr: ['Recruitment', 'Training', 'Compensation', 'Employee Relations'],
            operations: ['Supply Chain', 'Logistics', 'Facilities', 'Procurement'],
            research: ['Product Research', 'Market Research', 'Innovation', 'Prototyping']
        };
        
        divisionSelect.addEventListener('change', function() {
            const division = this.value;
            
            // Clear department dropdown
            departmentSelect.innerHTML = '<option value="">Select a Department</option>';
            
            if (division && departments[division]) {
                // Add departments for the selected division
                departments[division].forEach(dept => {
                    const option = document.createElement('option');
                    option.value = dept.toLowerCase().replace(/\s+/g, '-');
                    option.textContent = dept;
                    departmentSelect.appendChild(option);
                });
            }
            
            updateSearchButton();
            updateSelectionSummary();
        });
        
        departmentSelect.addEventListener('change', updateSearchButton);
        yearSelect.addEventListener('change', updateSearchButton);
        
        function updateSearchButton() {
            searchBtn.disabled = !(divisionSelect.value && departmentSelect.value && yearSelect.value);
        }
        
        function updateSelectionSummary() {
            const division = divisionSelect.options[divisionSelect.selectedIndex].text;
            const department = departmentSelect.options[departmentSelect.selectedIndex].text;
            const year = yearSelect.value;
            
            if (division && department && year) {
                selectedResult.textContent = `${division} - ${department} - ${year}`;
            } else {
                selectedResult.textContent = 'Please make your selections above';
            }
        }
        
        searchBtn.addEventListener('click', function() {
            const division = divisionSelect.value;
            const department = departmentSelect.options[departmentSelect.selectedIndex].text;
            const year = yearSelect.value;
            
            // Simulate loading results
            resultsContainer.innerHTML = `
                <div class="box">
                    <div class="box-title">
                        <i class="fas fa-chart-line"></i>
                        <h2>Risk Overview for ${department} (${year})</h2>
                    </div>
                    <p>Risk level: <strong>Medium</strong></p>
                    <p>Last assessment: March 15, ${year}</p>
                    <p>Number of identified risks: 12</p>
                    <p>Mitigation progress: 75% complete</p>
                </div>
                
                <div class="box">
                    <div class="box-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h2>Top Risks</h2>
                    </div>
                    <ul style="margin-left: 20px;">
                        <li>Cybersecurity threats</li>
                        <li>Supply chain disruptions</li>
                        <li>Key personnel dependency</li>
                    </ul>
                </div>
                
                <div class="box">
                    <div class="box-title">
                        <i class="fas fa-tasks"></i>
                        <h2>Action Items</h2>
                    </div>
                    <ul style="margin-left: 20px;">
                        <li>Update business continuity plan</li>
                        <li>Conduct risk assessment workshop</li>
                        <li>Review insurance coverage</li>
                    </ul>
                </div>
            `;
        });
    </script>
</body>
</html>